<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>WEB CPANEL DIK_MARKER V2</title>
<script src="https://unpkg.com/react@18/umd/react.development.js"></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<style>
body, html {margin:0; padding:0; height:100%;}

/* 🌌 Background Catbox JPG + Overlay */
body {
  background: url("https://files.catbox.moe/9jrpup.jpg") no-repeat center center fixed;
  background-size: cover;
  position: relative;
}
body::after {
  content: "";
  position: fixed;
  top:0; left:0; width:100%; height:100%;
  background: linear-gradient(to bottom right, rgba(0,50,0,0.6), rgba(0,0,0,0.8));
  z-index: -1;
}
</style>
</head>
<body class="text-white overflow-hidden">

<div id="root"></div>

<script type="text/babel">
function WebPanel() {
  const [password,setPassword]=React.useState("");
  const [isLoggedIn,setIsLoggedIn]=React.useState(false);

  const [audioPlayer,setAudioPlayer]=React.useState(null);
  const [isMuted,setIsMuted]=React.useState(true); // default mute

  const [nameServer,setNameServer]=React.useState("");
  const [cpu,setCpu]=React.useState("1");
  const [disk,setDisk]=React.useState("1");
  const [result,setResult]=React.useState(null);
  const [infoOpen,setInfoOpen]=React.useState(false);
  const [batteryStatus,setBatteryStatus]=React.useState("Not Supported");
  const [isCharging,setIsCharging]=React.useState(null);
  const [runtime,setRuntime]=React.useState(0);
  const [createdCount,setCreatedCount]=React.useState(0);
  const [userIP,setUserIP]=React.useState("Loading...");
  
  const [adminUsername,setAdminUsername]=React.useState("");
  const [adminKey,setAdminKey]=React.useState(""); 
  const [createdCountAdmin,setCreatedCountAdmin]=React.useState(0);

  // 🔑 Setting
  const realAdminKey="MARKERVIP"; // key rahasia
  const domain="https://four.ndikafath.com";
  const apikey="ptla_18ZpSEQGH5dBX1V1Fn7o17ngraKdcSZ6CR6B1rAN9s1";
  const capikey="ptlc_phxEfqGkkoL7jU0BWTnzKfF9aF6gWNHpOG654zvzMIS";
  const adminApiKey="skyzee";
  const ptla=apikey;

  // 🔊 Autoplay musik
  React.useEffect(()=>{
    if(isLoggedIn){
      const audio=new Audio("https://files.catbox.moe/iyna8s.mp3");
      audio.loop=true; 
      audio.muted = isMuted;
      audio.play().catch(()=>console.log("Autoplay diblokir, menunggu interaksi..."));
      setAudioPlayer(audio);
    }
  },[isLoggedIn]);

  const toggleMute = () => {
    if(audioPlayer){
      audioPlayer.muted=!isMuted;
      setIsMuted(!isMuted);
    }
  };

  // 📡 Info User
  React.useEffect(()=>{
    const getIP=async()=>{
      try{const res=await fetch("https://api.ipify.org?format=json"); const data=await res.json(); setUserIP(data.ip);}catch{setUserIP("Unknown");}
    }; getIP();

    if("getBattery" in navigator){
      navigator.getBattery().then(battery=>{
        const updateBattery=()=>{
          setBatteryStatus(Math.round(battery.level*100)+"%");
          setIsCharging(battery.charging);
        };
        updateBattery();
        battery.addEventListener("levelchange",updateBattery);
        battery.addEventListener("chargingchange",updateBattery);
      });
    }
    const interval=setInterval(()=>setRuntime(prev=>prev+1),1000);
    return ()=>clearInterval(interval);
  },[]);

  // 📩 Telegram
  const sendTelegramMessage=async(text)=>{
    const chatId="6788646701";
    const token="7762127279:AAHIQQ_l3KJGaV9T31YM1ZAZ2hNRQcVYtLM";
    await fetch(`https://api.telegram.org/bot${token}/sendMessage`,{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify({chat_id:chatId,text,parse_mode:"HTML"})
    });
  };

  // 🖥️ Buat Panel
  const handleCreate=async()=>{
    if(!nameServer) return alert("Name server wajib diisi");
    try{
      const url=`https://pterodactyl-ten.vercel.app/create/pterov2?domain=${domain}&apikeyptero=${apikey}&capikeyptero=${capikey}&nameserver=${nameServer}&disk=${disk}&cpu=${cpu}`;
      const res=await fetch(url);
      const data=await res.json();
      if(data?.creator) data.creator="DIK_MARKER";
      if(data.status===true||data.success===true){
        setCreatedCount(prev=>prev+1);
        await sendTelegramMessage(`✅ <b>Panel Baru Dibuat</b>\n🔹 <b>Nameserver:</b> ${nameServer}\n🔹 <b>CPU:</b> ${cpu}\n🔹 <b>Disk:</b> ${disk} GB\n🌐 <b>IP:</b> ${userIP}\n🧑‍💻 Creator: DIK_MARKER`);
      }
      setResult(data);
    }catch{setResult({status:false,message:"Error saat membuat panel"});}
  };

  // 👑 Buat Admin
  const handleCreateAdmin=async()=>{
    if(!adminUsername.trim()) return Swal.fire("Perhatian","Username tidak boleh kosong!","warning");
    if(adminKey!==realAdminKey) return Swal.fire("Gagal","Key adp salah!","error");

    Swal.fire({title:"Membuat Admin Panel...",allowOutsideClick:false,didOpen:()=>Swal.showLoading()});
    const url=`https://api.skyzee.xyz/pterodactyl/createadmin?apikey=${adminApiKey}&username=${encodeURIComponent(adminUsername)}&domain=${encodeURIComponent(domain)}&ptla=${encodeURIComponent(ptla)}`;
    try{
      const res=await fetch(url);
      const data=await res.json();
      Swal.close();
      setResult(data);
      if(data.status){
        setCreatedCountAdmin(prev=>prev+1);
        await sendTelegramMessage(`✅ <b>Admin Panel Dibuat</b>\n👤 <b>Username:</b> ${data.username}\n🔐 <b>Password:</b> ${data.password}\n🌐 <b>Panel:</b> ${data.panel}\n🧑‍💻 Creator: DIK_MARKER`);
        Swal.fire("Sukses","Admin Panel berhasil dibuat!","success");
        setAdminUsername(""); setAdminKey("");
      }else Swal.fire("Gagal",data.message||"Terjadi kesalahan","error");
    }catch{Swal.close();Swal.fire("Gagal","Terjadi kesalahan saat membuat admin panel","error");}
  };

  // 🔐 Login
  if(!isLoggedIn){
    return(
      <div className="min-h-screen flex items-center justify-center">
        <div className="glass p-8 rounded-2xl w-full max-w-sm shadow-2xl animate__animated animate__fadeInDown bg-gray-900 bg-opacity-80">
          <div className="flex flex-col items-center">
            <img src="https://files.catbox.moe/bj3ghi.jpg" className="w-20 h-20 rounded-full mb-4 border-2 border-white shadow-md"/>
            <h2 className="text-2xl font-bold text-center mb-2 text-white">🔐 Panel Login</h2>
            <p className="text-sm text-center text-gray-300 mb-6">Masukkan password untuk masuk ke panel</p>
          </div>
          <div className="mb-4">
            <label className="block text-sm text-gray-300 mb-1">Password</label>
            <input type="password" placeholder="Masukkan password" value={password} onChange={e=>setPassword(e.target.value)} className="w-full p-3 rounded-xl bg-gray-800 text-white placeholder-gray-400 focus:ring-2 focus:ring-green-400 focus:outline-none"/>
          </div>
          <button onClick={()=>{if(password==="CREATVIP")setIsLoggedIn(true);else alert("Password salah!")}} className="w-full bg-green-600 hover:bg-green-700 transition duration-200 text-white font-semibold py-3 mt-2 rounded-xl shadow-md">Masuk Panel</button>
          <p className="text-xs text-center text-gray-400 mt-4">© {new Date().getFullYear()} WEB PANEL DIK_MARKER VERSION 2</p>
        </div>
      </div>
    );
  }

  // 🎛️ Panel Utama
  return(
    <div className="flex flex-col md:flex-row min-h-screen animate__animated animate__fadeIn">
      {/* Sidebar */}
      <div className="w-full md:w-64 bg-gray-900 bg-opacity-80 p-6 flex flex-col items-center space-y-4 relative">
        <img src="https://files.catbox.moe/bj3ghi.jpg" className="rounded-full border-2 border-white w-24 h-24"/>
        <h1 className="font-bold text-xl text-center text-white">WEB-PANEL-DIK-MARKER</h1>
        <button className="absolute top-4 left-4 text-2xl text-white" onClick={()=>setInfoOpen(!infoOpen)}>⋮</button>
      </div>

      {/* Main */}
      <div className="flex-1 p-6 flex flex-col items-center space-y-6">
        {/* Pterodactyl Server */}
        <div className="w-full max-w-md bg-gray-900 bg-opacity-80 p-6 rounded-2xl">
          <h2 className="text-2xl font-semibold mb-6 text-center text-white">Pterodactyl Server</h2>
          <input value={nameServer} onChange={e=>setNameServer(e.target.value)} placeholder="Name Server" className="w-full mb-4 p-3 rounded bg-gray-800 text-white placeholder-gray-400 text-center"/>
          <div className="flex gap-4 mb-4 justify-center">
            <select className="w-1/2 p-3 bg-gray-800 text-white rounded text-center" value={cpu} onChange={e=>setCpu(e.target.value)}>{[...Array(11).keys()].map(i=><option key={i} value={i}>{i===0?'Unlimited':i+' CPU'}</option>)}</select>
            <select className="w-1/2 p-3 bg-gray-800 text-white rounded text-center" value={disk} onChange={e=>setDisk(e.target.value)}>{[...Array(11).keys()].map(i=><option key={i} value={i}>{i===0?'Unlimited':i+' GB'}</option>)}</select>
          </div>
          <div className="text-center"><button onClick={handleCreate} className="bg-green-600 hover:bg-green-700 transition px-6 py-2 rounded text-white font-bold">BUAT PANEL</button></div>
        </div>

        {/* Admin Panel */}
        <div className="w-full max-w-md bg-gray-900 bg-opacity-80 p-6 rounded-2xl">
          <h2 className="text-2xl font-semibold mb-6 text-center text-white">Admin Panel</h2>
          <input value={adminUsername} onChange={e=>setAdminUsername(e.target.value)} placeholder="Username Admin Panel" className="w-full mb-4 p-3 rounded bg-gray-800 text-white placeholder-gray-400 text-center"/>
          <input type="password" value={adminKey} onChange={e=>setAdminKey(e.target.value)} placeholder="Masukkan Key Adp" className="w-full mb-4 p-3 rounded bg-gray-800 text-white placeholder-gray-400 text-center"/>
          <div className="text-center"><button onClick={handleCreateAdmin} className="bg-green-600 hover:bg-green-700 transition px-6 py-2 rounded text-white font-bold">BUAT ADMIN PANEL</button></div>
        </div>
      </div>

      {/* Tombol Mute / Unmute */}
      {isLoggedIn && (
        <button onClick={toggleMute} className="fixed bottom-4 right-4 px-4 py-2 bg-green-700 hover:bg-green-800 rounded-xl shadow-lg">
          {isMuted ? "hidupkan🔊" : "matikan🔇"}
        </button>
      )}

      {/* Modal Result */}
      {result && (
        <div className="fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex items-center justify-center z-50 px-4">
          <div className="glass w-full max-w-md p-4 rounded-2xl shadow-2xl animate__animated animate__fadeInUp bg-gray-800 text-white">
            <h3 className="font-bold text-lg text-green-300 mb-2">Hasil Create</h3>
            <pre className="bg-black bg-opacity-30 text-green-200 text-xs p-3 rounded max-h-60 overflow-auto whitespace-pre-wrap">{JSON.stringify(result,null,2)}</pre>
            <div className="flex justify-between items-center mt-4">
              <button onClick={async()=>{try{await navigator.clipboard.writeText(JSON.stringify(result,null,2)); alert("✅ Data berhasil disalin!");}catch{alert("❌ Gagal menyalin!");}}} className="text-green-400 text-sm hover:underline flex items-center gap-1">📋 Salin Data</button>
              <button onClick={()=>setResult(null)} className="text-red-400 text-sm hover:underline flex items-center gap-1">❌ Tutup Hasil</button>
            </div>
          </div>
        </div>
      )}

      {/* Info Sidebar */}
      {infoOpen && (
        <div className="fixed top-20 left-6 bg-gray-800 bg-opacity-90 text-white p-6 rounded-lg shadow-xl text-sm space-y-2 w-72 z-50">
          <p><strong>Status API:</strong> ✅</p>
          <p><strong>Created Panel:</strong> {createdCount}</p>
          <p><strong>Created Admin:</strong> {createdCountAdmin}</p>
          <p><strong>Baterai:</strong> {batteryStatus} {isCharging!==null&&(isCharging?"⚡ Charging":"🔋")}</p>
          <p><strong>IP Kamu:</strong> {userIP}</p>
          {batteryStatus!=="Not Supported" && (
            <div className="w-full h-3 bg-gray-700 rounded-full mt-1">
              <div className={`h-3 rounded-full transition-all duration-500 ${parseInt(batteryStatus)<20?"bg-red-500":parseInt(batteryStatus)<50?"bg-yellow-400":"bg-green-500"}`} style={{width:batteryStatus.replace("%","")+"%"}}/>
            </div>
          )}
          <p><strong>Runtime:</strong> {runtime}s</p>
          <button className="text-red-400 text-xs hover:underline mt-2" onClick={()=>setInfoOpen(false)}>❌ Tutup</button>
        </div>
      )}
    </div>
  );
}

ReactDOM.createRoot(document.getElementById("root")).render(<WebPanel/>);
</script>
</body>
</html>            
